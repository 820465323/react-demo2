<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hello React!</title>
    <style>
        td {
            height: 30px;
            border-bottom: 2px solid royalblue;
        }

        table {
            border: 1px solid cornflowerblue;
            margin-top: 30px;
        }
    </style>

</head>
<body style="width: 100%;height: 700px">
<!--vue渲染-->
<div id="app"
     style="border: 1px solid transparent;width: 200px;height: 700px;display: inline-block;vertical-align: middle">
    <button @click="method()">抽签了</button>

    <!--A-->
    <table id="table1" style="border: 1px solid cornflowerblue;width: 200px;height: 100px;">
        <tr v-for="(res,index) in res0[0]" :key="index">
            <td>{{index+1}}</td>
            <td>{{res.name}}</td>
        </tr>

        <!--如果长度小于2时证明长度为1,则需要创建空的行和列进行填充-->
        <tr v-for="(res,index) in res0[0]" :key="2" v-if="res0[0].length<2">
            <td></td>
            <td></td>
        </tr>

        <tr v-for="(res,index) in res0[1]" :key="3" v-if="res0[1].length<2">
            <td></td>
            <td></td>
        </tr>
        <tr v-for="(res,index) in res0[1]" :key="4">
            <td>{{index+1}}</td>
            <td>{{res.name}}</td>
        </tr>
    </table>

    <!--B-->
    <table id="table2" style="border: 1px solid cornflowerblue;width: 200px;height: 50px;">
        <tr v-for="(arr,index) in res1[0]" :key="index">
            <td>{{index+1}}</td>
            <td>{{arr.name}}</td>
        </tr>
        <tr v-for="(arr,index) in res1[0]" :key="6" v-if="res1[0].length<2">
            <td></td>
            <td></td>
        </tr>


        <tr v-for="(arr,index) in res1[1]" :key="7" v-if="res1[1].length<2">
            <td></td>
            <td></td>
        </tr>
        <tr v-for="(arr,index) in res1[1]">
            <td>{{index+1}}</td>
            <td>{{arr.name}}</td>
        </tr>
    </table>


    <!--C-->
    <table id="table3" style="border: 1px solid cornflowerblue;width: 200px;height: 50px">
        <tr v-for="(arr,index) in res2[0]">
            <td>{{index+1}}
            </td>
            <td>{{arr.name}}</td>
        </tr>
        <tr v-for="(arr,index) in res2[0]" :key="10" v-if="res2[0].length<2">
            <td>
            </td>
            <td></td>
        </tr>

        <tr v-for="(arr,index) in res2[1]" :key="11" v-if="res2[1].length<2">
            <td>
            </td>
            <td></td>
        </tr>
        <tr v-for="(arr,index) in res2[1]">
            <td>{{index+1}}
            </td>
            <td>{{arr.name}}</td>
        </tr>

    </table>

    <!--D-->
    <table id="table4" style="border: 1px solid cornflowerblue;width: 200px;height: 50px">
        <tr v-for="(arr,index) in res3[0]" :key="index">
            <td>{{index+1}}</td>
            <td>{{arr.name}}</td>
        </tr>
        <tr v-for="(arr,index) in res3[0]" :key="14" v-if="res3[0].length<2">
            <td></td>
            <td></td>
        </tr>


        <tr v-for="(arr,index) in res3[1]" :key="15" v-if="res3[1].length<2">
            <td></td>
            <td></td>
        </tr>
        <tr v-for="(arr,index) in res3[1]">
            <td>{{index+1}}</td>
            <td>{{arr.name}}</td>
        </tr>
    </table>
</div>

<!--第一个关系框-->
<div id="app2" style="display: none">
    <div style="border: 1px solid transparent;width: 100%;height: 133px;">

        <div style="border: 1px solid transparent;width: 90%;height: 48%;display: inline-block;vertical-align: middle">
            <div style="border-right: 3px solid blue;border-top: 3px solid blue;border-bottom: 3px solid blue;width: 10px;height:80%;display: inline-block;vertical-align: middle">
                <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 10px;text-align: center;background-color: white;position: relative;z-index: 9999">
                    1
                </div>
            </div>
            <div style="border: 1px solid blue;width: 85%;display: inline-block;vertical-align: middle"></div>
        </div>

        <div style="border: 1px solid transparent;width: 90%;height: 48%;display: inline-block;vertical-align: middle">
            <div style="border-right: 3px solid blue;border-top: 3px solid blue;border-bottom: 3px solid blue;width: 10px;height:80%;display: inline-block;vertical-align: middle">
                <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 10px;text-align: center;background-color: white;position: relative;z-index: 9999">
                    2
                </div>
            </div>
            <div style="border: 1px solid blue;width: 85%;display: inline-block;vertical-align: middle"></div>
        </div>

        <div style="border: 3px solid blue;width: 7px;height: 55%;display: inline-block;vertical-align: middle;margin-top: -70px;margin-left: -5px">
            <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;text-align: center;background-color: white;margin-top: 22px;position: relative;z-index: 9999">
                9
            </div>
        </div>
    </div>

    <div style="border: 1px solid transparent;width: 100%;height: 133px;margin-top: 31px;">
        <div style="border: 1px solid transparent;width: 90%;height: 48%;display: inline-block;vertical-align: middle">
            <div style="border-right: 3px solid blue;border-top: 3px solid blue;border-bottom: 3px solid blue;width: 10px;height:80%;display: inline-block;vertical-align: middle">
                <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 10px;text-align: center;background-color: white;position: relative;z-index: 9999">
                    3
                </div>
            </div>
            <div style="border: 1px solid blue;width: 85%;display: inline-block;vertical-align: middle"></div>
        </div>

        <div style="border: 1px solid transparent;width: 90%;height: 48%;display: inline-block;vertical-align: middle">
            <div style="border-right: 3px solid blue;border-top: 3px solid blue;border-bottom: 3px solid blue;width: 10px;height:80%;display: inline-block;vertical-align: middle">
                <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 10px;text-align: center;background-color: white">
                    4
                </div>
            </div>
            <div style="border: 1px solid blue;width: 85%;display: inline-block;vertical-align: middle"></div>
        </div>

        <div style="border: 3px solid blue;width: 7px;height: 55%;display: inline-block;vertical-align: middle;margin-top: -70px;margin-left: -5px">
            <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;text-align: center;background-color: white;margin-top: 22px;position: relative;z-index: 9999">
                10
            </div>
        </div>
    </div>

    <div style="border: 1px solid transparent;width: 100%;height: 133px;margin-top: 31px;">
        <div style="border: 1px solid transparent;width: 90%;height: 48%;display: inline-block;vertical-align: middle">
            <div style="border-right: 3px solid blue;border-top: 3px solid blue;border-bottom: 3px solid blue;width: 10px;height:80%;display: inline-block;vertical-align: middle">
                <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 10px;text-align: center;background-color: white;position: relative;z-index: 9999">
                    5
                </div>
            </div>
            <div style="border: 1px solid blue;width: 85%;display: inline-block;vertical-align: middle"></div>
        </div>

        <div style="border: 1px solid transparent;width: 90%;height: 48%;display: inline-block;vertical-align: middle">
            <div style="border-right: 3px solid blue;border-top: 3px solid blue;border-bottom: 3px solid blue;width: 10px;height:80%;display: inline-block;vertical-align: middle">
                <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 10px;text-align: center;background-color: white;position: relative;z-index: 9999">
                    6
                </div>
            </div>
            <div style="border: 1px solid blue;width: 85%;display: inline-block;vertical-align: middle"></div>
        </div>

        <div style="border: 3px solid blue;width: 7px;height: 55%;display: inline-block;vertical-align: middle;margin-top: -70px;margin-left: -5px">
            <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;text-align: center;background-color: white;margin-top: 22px;position: relative;z-index: 9999">
                11
            </div>
        </div>
    </div>

    <div style="border: 1px solid transparent;width: 100%;height: 133px;margin-top: 31px;">
        <div style="border: 1px solid transparent;width: 90%;height: 48%;display: inline-block;vertical-align: middle">
            <div style="border-right: 3px solid blue;border-top: 3px solid blue;border-bottom: 3px solid blue;width: 10px;height:80%;display: inline-block;vertical-align: middle">
                <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 10px;text-align: center;background-color: white;position: relative;z-index: 9999">
                    7
                </div>
            </div>
            <div style="border: 1px solid blue;width: 85%;display: inline-block;vertical-align: middle"></div>
        </div>

        <div style="border: 1px solid transparent;width: 90%;height: 48%;display: inline-block;vertical-align: middle">
            <div style="border-right: 3px solid blue;border-top: 3px solid blue;border-bottom: 3px solid blue;width: 10px;height:80%;display: inline-block;vertical-align: middle">
                <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 10px;text-align: center;background-color: white;position: relative;z-index: 9999">
                    8
                </div>
            </div>
            <div style="border: 1px solid blue;width: 85%;display: inline-block;vertical-align: middle"></div>
        </div>

        <div style="border: 3px solid blue;width: 7px;height: 55%;display: inline-block;vertical-align: middle;margin-top: -70px;margin-left: -5px">
            <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;text-align: center;background-color: white;margin-top: 22px;position: relative;z-index: 9999">
                12
            </div>
        </div>
    </div>
</div>

<!--第二个关系框-->
<div id="app3" style="display: none">
    <div style="border: 1px solid transparent;width: 100%;height: 133px;">
        <div style="border: 1px solid blue;width: 85%;margin-top: -2px;display: inline-block;vertical-align: middle;margin-left: -10px;">
        </div>

        <div style="border-right: 3px solid blue;border-left: 3px solid blue;border-top: 3px solid blue;width: 7px;height: 80%;display: inline-block;vertical-align: middle;margin-top: 25px">
            <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 86px;background-color: white;position: relative;z-index: 9999">
                13
            </div>
        </div>
    </div>

    <div style="border: 1px solid transparent;width: 100%;height: 133px;margin-top: 31px;">
        <div style="border: 1px solid blue;width: 85%;margin-top: 30px;display: inline-block;vertical-align: middle;margin-left: -10px">
        </div>

        <div style="border-right: 3px solid blue;border-left: 3px solid blue;border-bottom: 3px solid blue;width: 7px;height: 97%;display: inline-block;vertical-align: middle;margin-top:-32px">

        </div>
    </div>

    <div style="border: 1px solid transparent;width: 100%;height: 133px;margin-top: 32px">
        <div style="border: 1px solid blue;width: 85%;margin-top: -2px;display: inline-block;vertical-align: middle;margin-left: -10px;">
        </div>

        <div style="border-right: 3px solid blue;border-left: 3px solid blue;border-top: 3px solid blue;width: 7px;height: 80%;display: inline-block;vertical-align: middle;margin-top: 25px">
            <div style="border: 3px solid black;width: 20px;height: 20px;border-radius: 100%;margin-top: 106px;background-color: white;position: relative;z-index: 9999">
                14
            </div>
        </div>
    </div>

    <div style="border: 1px solid transparent;width: 100%;height: 133px;margin-top: 31px;">
        <div style="border: 1px solid blue;width: 85%;margin-top: 30px;display: inline-block;vertical-align: middle;margin-left: -10px">
        </div>

        <div style="border-right: 3px solid blue;border-left: 3px solid blue;border-bottom: 3px solid blue;width: 7px;height: 97%;display: inline-block;vertical-align: middle;margin-top:-32px">

        </div>
    </div>
</div>

<!--第三个关系框-->
<div id="app4" style="display: none">
    <div style="border-top: 3px solid blue;width: 200px;height: 70%;border-bottom: 3px solid blue;margin-top: 85px;margin-left: -20px;">
        <div style="border: 3px solid blue;width: 7px;height: 100%;margin-top: -3px;float: right">
            <div style="border: 3px solid black;width: 20px;height: 20px;background-color: white;border-radius: 100%;margin-top: 164px;position: relative;z-index: 9999">
                15
            </div>
        </div>
    </div>
</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<!--打印功能-->
<div style="display: none;" id="app5">
    <embed width="100%" height="100%" name="plugin" id="plugin" src="./images/女单对阵图.pdf" type="application/pdf"
           internalinstanceid="20">
</div>
</body>
<script src="../../jquery-min.js"></script>
<script src="../../vue.js"></script>
<script src="../../vue-resource.js"></script>
<script>

    let vue = new Vue({
        el: '#app',
        data(){
            return {
                arr: [],
                arr2: [],
                //当比赛人数<=16的数组机制
                res: [],
                res0: [],
                res1: [],
                res2: [],
                res3: []
            }
        },
        created: function () {
            $.get("http://localhost:3002", (result) => {
                {
                    for (let i = 0; i < result.length; i++) {
                        this.arr.push(result[i]);
                    }
                }
            });
        },
        methods: {
            method(){
                function sub(data) {
                    $.get("http://localhost:3002", (result) => {
                        {
                            for (let i = 0; i < result.length; i++) {
                                data.push(result[i]);
                            }
                        }
                    });
                }

                if (window.confirm('你想重新排序吗???')) {
                    sub(this.arr);
                    document.getElementById('app5').style = 'display: inline-block;vertical-align: middle;width:800px;height:800px';
                    document.getElementById('app2').style = 'border: 1px solid transparent;width: 150px;display: inline-block;vertical-align: middle;height: 635px;margin-top: 55px;margin-left: -10px';
                    document.getElementById('app3').style = 'border: 1px solid transparent;width: 150px;display: inline-block;vertical-align: middle;height: 635px;margin-top: 50px';
                    document.getElementById('app4').style = 'border: 1px solid transparent;width: 150px;height: 500px;display: inline-block;vertical-align: middle';
                    let index;
                    let sum = 0;
                    let a = new Promise((resolve, reject) => {
                        //轮训制循环数组,只要长度大于0则一直抽取随机数放入新数组中
                        while (this.arr.length > 0) {
                            //取1-100的随机数中的整数
                            index = Math.floor(Math.random() * 10);
                            //首先判断该下标的内容不能为空
                            if (this.arr[index] != null) {
                                //再判断在该数组长度大于0时，且插入的数据与新数组末尾的数据不同时则push该数据
                                //如果相同则再判断是否和-3之后的下标是否相同 不同则在-2的下标添加数据
                                if (this.arr2.length > 0 && this.arr2[this.arr2.length - 1].name == this.arr[index].name) {
                                    if (this.arr2.length >= 3 && this.arr2[this.arr2.length - 3].name != this.arr[index].name) {
                                        console.log('this.arr2[this.arr2.length - 2] = ' + JSON.stringify(this.arr[index]));
                                        this.arr2.splice(this.arr2.length - 2, 0, this.arr[index]);
                                        this.arr.splice(index, 1);
                                        //上述条件成立则再判断是否和-5之后的下标是否相同,不同则在-4的下标添加数据
                                    } else if (this.arr2.length >= 5 && this.arr2[this.arr2.length - 5].name != this.arr[index].name) {
                                        console.log('continue ' + JSON.stringify(this.arr[index]));
                                        this.arr2.splice(this.arr2.length - 4, 0, this.arr[index]);
                                        this.arr.splice(index, 1);
                                    } else if (this.arr2.length >= 7 && this.arr2[this.arr2.length - 7].name != this.arr[index].name) {
                                        console.log('continue ' + JSON.stringify(this.arr[index]));
                                        this.arr2.splice(this.arr2.length - 6, 0, this.arr[index]);
                                        this.arr.splice(index, 1);
                                    } else if (this.arr2.length >= 9 && this.arr2[this.arr2.length - 9].name != this.arr[index].name) {
                                        console.log('continue ' + JSON.stringify(this.arr[index]));
                                        this.arr2.splice(this.arr2.length - 8, 0, this.arr[index]);
                                        this.arr.splice(index, 1);
                                    } else if (this.arr2.length >= 11 && this.arr2[this.arr2.length - 11].name != this.arr[index].name) {
                                        console.log('continue ' + JSON.stringify(this.arr[index]));
                                        this.arr2.splice(this.arr2.length - 10, 0, this.arr[index]);
                                        this.arr.splice(index, 1);
                                    } else if (this.arr2.length >= 13 && this.arr2[this.arr2.length - 13].name != this.arr[index].name) {
                                        console.log('continue ' + JSON.stringify(this.arr[index]));
                                        this.arr2.splice(this.arr2.length - 12, 0, this.arr[index]);
                                        this.arr.splice(index, 1);
                                    } else if (this.arr2.length >= 15 && this.arr2[this.arr2.length - 15].name != this.arr[index].name) {
                                        console.log('continue ' + JSON.stringify(this.arr[index]));
                                        this.arr2.splice(this.arr2.length - 14, 0, this.arr[index]);
                                        this.arr.splice(index, 1);
                                    } else if (this.arr2[0].name != this.arr[index].name) {
                                        console.log('continue ' + JSON.stringify(this.arr[index]));
                                        this.arr2.splice(0, 0, this.arr[index]);
                                        this.arr.splice(index, 1);
                                    }
                                    //=====================分割线===============================
                                    //一层相邻完成,但由于相同元素过多时，防止while陷入死循环,所以此时加入以下判断
                                    else if (sum > 500) {
                                        if (this.arr2.length >= 2 && this.arr2[this.arr2.length - 2].name != this.arr[index].name) {
                                            this.arr2.splice(this.arr2.length - 1, 0, this.arr[index]);
                                            this.arr.splice(index, 1);
                                        } else if (this.arr2.length >= 4 && this.arr2[this.arr2.length - 4].name != this.arr[index].name) {
                                            this.arr2.splice(this.arr2.length - 3, 0, this.arr[index]);
                                            this.arr.splice(index, 1);
                                        }
                                        else if (this.arr2.length >= 6 && this.arr2[this.arr2.length - 6].name != this.arr[index].name) {
                                            this.arr2.splice(this.arr2.length - 5, 0, this.arr[index]);
                                            this.arr.splice(index, 1);
                                        }
                                        else if (this.arr2.length >= 8 && this.arr2[this.arr2.length - 8].name != this.arr[index].name) {
                                            this.arr2.splice(this.arr2.length - 7, 0, this.arr[index]);
                                            this.arr.splice(index, 1);
                                        } else if (this.arr2.length >= 10 && this.arr2[this.arr2.length - 10].name != this.arr[index].name) {
                                            this.arr2.splice(this.arr2.length - 9, 0, this.arr[index]);
                                            this.arr.splice(index, 1);
                                        } else if (this.arr2.length >= 12 && this.arr2[this.arr2.length - 12].name != this.arr[index].name) {
                                            this.arr2.splice(this.arr2.length - 11, 0, this.arr[index]);
                                            this.arr.splice(index, 1);
                                        }
                                        else if (this.arr2.length >= 14 && this.arr2[this.arr2.length - 14].name != this.arr[index].name) {
                                            this.arr2.splice(this.arr2.length - 13, 0, this.arr[index]);
                                            this.arr.splice(index, 1);
                                        }
                                    }

                                    //否则跳出本次循环
                                    else {
                                        sum++;
                                        console.log(sum);
                                        continue;
                                    }
                                }
                                //如果不相同则加入数据
                                else {
                                    this.arr2.push(this.arr[index]);
                                    this.arr.splice(index, 1);
                                }

                            }
                        }
                        resolve(this.arr2);
                    });
                    //异步控制
                    let b = new Promise((resolve, reject) => {
                        //拆分成四组
                        let s = this.arr2.length / 4;
                        for (let i = 0, len = this.arr2.length; i < len; i += s) {
                            this.res.push(this.arr2.slice(i, i + s));
                        }
                        resolve(this.res);
                    });
                    let c = new Promise((resolve, reject) => {
                        if (this.arr2.length <= 16) {
                            //判断四个场台对应的数组长度
                            if (this.res[0].length <= 2) {
                                for (let i = 0, len = this.res[0].length; i < len; i += 1) {
                                    this.res0.push(this.res[0].slice(i, i + 1));
                                }
                            } else {
                                for (let i = 0, len = this.res[0].length; i < len; i += 2) {
                                    this.res0.push(this.res[0].slice(i, i + 2));
                                }
                            }

                            if (this.res[1].length <= 2) {
                                for (let i = 0, len = this.res[1].length; i < len; i += 1) {
                                    this.res1.push(this.res[1].slice(i, i + 1));
                                }
                            } else {
                                for (let i = 0, len = this.res[1].length; i < len; i += 2) {
                                    this.res1.push(this.res[1].slice(i, i + 2));
                                }
                            }

                            if (this.res[2].length <= 2) {
                                for (let i = 0, len = this.res[2].length; i < len; i += 1) {
                                    this.res2.push(this.res[2].slice(i, i + 1));
                                }
                            } else {
                                for (let i = 0, len = this.res[2].length; i < len; i += 2) {
                                    this.res2.push(this.res[2].slice(i, i + 2));
                                }
                            }

                            if (this.res[3].length <= 2) {
                                for (let i = 0, len = this.res[3].length; i < len; i += 1) {
                                    this.res3.push(this.res[3].slice(i, i + 1));
                                }
                            } else {
                                for (let i = 0, len = this.res[3].length; i < len; i += 2) {
                                    this.res3.push(this.res[3].slice(i, i + 2));
                                }
                            }
                        }
                        resolve(this.arr2);
                    });
                    a.then((data) => {
                        return b;
                    }).catch((err) => {
                        alert('a      =      ' + err);
                    }).then((data) => {
                        return c;
                    }).catch((err) => {
                        console.log('b      =      ' + err);
                    }).then((data) => {
                        //清空数组
                        data.splice(0, data.length);
                    }).catch((err) => {
                        alert('c      =      ' + err);
                    });
                    /*setTimeout(() => {
                        //设定一个长度为4的数组用于抽取随机数来随机排列table
                        let arr = [0, 1, 2, 3];
                        while (arr.length > 3) {
                            let index = Math.floor(Math.random() * 100);
                            if (arr[index] == 0 || arr[index] == 1 || arr[index] == 2 || arr[index] == 3) {
                                if (arr[index] == 0) {
                                    //在末尾克隆该选择器元素并将首位删除
                                    $('#table1').clone().appendTo('#app');
                                    $('#table1').eq(0).remove();
                                    break;
                                } else if (arr[index] == 1) {
                                    $('#table1').clone().appendTo('#app');
                                    $('#table2').clone().appendTo('#app');
                                    $('#table1').eq(0).remove();
                                    $('#table2').eq(0).remove();
                                    break;
                                } else if (arr[index] == 2) {
                                    $('#table1').clone().appendTo('#app');
                                    $('#table2').clone().appendTo('#app');
                                    $('#table3').clone().appendTo('#app');
                                    $('#table1').eq(0).remove();
                                    $('#table2').eq(0).remove();
                                    $('#table3').eq(0).remove();
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }, 0.1);*/
                }
            }
        }
    });

</script>
</html>